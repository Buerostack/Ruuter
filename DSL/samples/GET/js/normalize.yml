input_validation:
  switch:
    - condition: ${incoming.params.q == null || incoming.params.q == ""}
      next: bad_request
  next: define_output

define_output:
  assign:
    output:
      original: ${incoming.params.q}
      normalized: ${ (incoming.params.q ?? "").trim().toLowerCase() }

response:
  return: ${output}
  next: end

bad_request:
  status: 400
  return: Query parameter 'q' expected. For example, '?q=mY saMPLE inPut '
  next: end